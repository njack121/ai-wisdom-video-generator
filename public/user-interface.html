<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Wisdom Video Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 600px;
            width: 100%;
            text-align: center;
        }
        
        .logo {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
            outline: none;
        }
        
        input[type="text"]:focus {
            border-color: #667eea;
        }
        
        .generate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-bottom: 20px;
        }
        
        .generate-btn:hover {
            transform: translateY(-2px);
        }
        
        .generate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .examples {
            margin-top: 30px;
            text-align: left;
        }
        
        .examples h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .example-item {
            background: #f8f9fa;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .example-item:hover {
            background: #e9ecef;
        }
        
        .example-prompt {
            font-weight: 600;
            color: #495057;
        }
        
        .example-desc {
            font-size: 14px;
            color: #6c757d;
            margin-top: 4px;
        }
        
        .video-result {
            margin-top: 30px;
            display: none;
        }
        
        .video-container {
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        
        iframe {
            width: 100%;
            height: 400px;
            border: none;
        }
        
        .loading {
            display: none;
            margin-top: 20px;
            color: #666;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .studio-link {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }
        
        .studio-btn {
            background: #28a745;
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            display: inline-block;
            transition: background-color 0.2s;
        }
        
        .studio-btn:hover {
            background: #218838;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">🎬✨</div>
        <h1>AI Wisdom Video Generator</h1>
        <p class="subtitle">Turn any wisdom quote or life lesson into a beautiful animated video</p>
        
        <div class="input-group">
            <input 
                type="text" 
                id="promptInput" 
                placeholder="Enter a wisdom quote or life lesson..."
                maxlength="100"
            >
        </div>
        
        <button class="generate-btn" onclick="generateVideo()">
            Generate Wisdom Video
        </button>
        
        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            Creating your wisdom video...
        </div>
        
        <div class="video-result" id="videoResult">
            <div class="video-container">
                <iframe id="videoFrame" src=""></iframe>
            </div>
            <button class="generate-btn" onclick="generateAnother()">
                Generate Another Video
            </button>
        </div>
        
        <div class="examples">
            <h3>💡 Try these examples:</h3>
            <div class="example-item" onclick="setPrompt('plant a tree')">
                <div class="example-prompt">"plant a tree"</div>
                <div class="example-desc">The best time to plant a tree was 20 years ago...</div>
            </div>
            <div class="example-item" onclick="setPrompt('persistence')">
                <div class="example-prompt">"persistence"</div>
                <div class="example-desc">Water dripping on a stone will make a hole</div>
            </div>
            <div class="example-item" onclick="setPrompt('self care')">
                <div class="example-prompt">"self care"</div>
                <div class="example-desc">You cannot pour from an empty cup</div>
            </div>
            <div class="example-item" onclick="setPrompt('flexibility')">
                <div class="example-prompt">"flexibility"</div>
                <div class="example-desc">The bamboo that bends is stronger than the oak</div>
            </div>
        </div>
        
        <div class="studio-link">
            <p style="color: #666; font-size: 14px; margin-bottom: 10px;">
                🎥 Generate unique wisdom videos from any concept or quote
            </p>
        </div>
    </div>

    <script>
        // Concept mapping - maps user prompts to your existing videos
        const conceptMap = {
            // Tree planting wisdom
            'plant': 'PlantingTreesWisdom',
            'tree': 'PlantingTreesWisdom', 
            'start': 'PlantingTreesWisdom',
            'begin': 'PlantingTreesWisdom',
            'timing': 'PlantingTreesWisdom',
            'procrastination': 'PlantingTreesWisdom',
            'now': 'PlantingTreesWisdom',
            'hope': 'PlantingTreesWisdom',
            'future': 'PlantingTreesWisdom',
            
            // Water drop stone
            'persistence': 'WaterDropStone',
            'persist': 'WaterDropStone',
            'consistent': 'WaterDropStone',
            'water': 'WaterDropStone',
            'stone': 'WaterDropStone',
            'breakthrough': 'WaterDropStone',
            'gradual': 'WaterDropStone',
            
            // Empty cup
            'self care': 'EmptyCupWisdom',
            'selfcare': 'EmptyCupWisdom',
            'empty': 'EmptyCupWisdom',
            'cup': 'EmptyCupWisdom',
            'burnout': 'EmptyCupWisdom',
            'help others': 'EmptyCupWisdom',
            'give': 'EmptyCupWisdom',
            
            // Bamboo oak
            'flexibility': 'BambooOakWisdom',
            'flexible': 'BambooOakWisdom',
            'adapt': 'BambooOakWisdom',
            'bamboo': 'BambooOakWisdom',
            'oak': 'BambooOakWisdom',
            'bend': 'BambooOakWisdom',
            'resilience': 'BambooOakWisdom',
            'storm': 'BambooOakWisdom'
        };
        
        function setPrompt(text) {
            document.getElementById('promptInput').value = text;
        }
        
        // Client-side AI wisdom generation
        function generateWisdomQuote(prompt) {
            const themes = {
                growth: [
                    "Every seed holds the promise of a forest.",
                    "Growth happens in the quiet moments between storms.",
                    "What grows slowly, grows strong.",
                    "The tree that would grow to heaven must send its roots to hell."
                ],
                persistence: [
                    "Persistence turns pressure into diamonds.",
                    "The river cuts through rock not by power, but by persistence.",
                    "Every drop counts in the ocean of success.",
                    "Don't quit before the miracle happens."
                ],
                balance: [
                    "Balance is not standing still, but moving gracefully.",
                    "The strongest trees bend with the wind.",
                    "Harmony is found in the dance between opposites.",
                    "Peace comes from balancing what is with what could be."
                ],
                hope: [
                    "Hope is the lighthouse in the storm of uncertainty.",
                    "Even the darkest night will end and the sun will rise.",
                    "Miracles happen to those who don't quit.",
                    "In every ending lies the seed of a new beginning."
                ],
                courage: [
                    "Courage is not the absence of fear, but action in its presence.",
                    "The brave may not live forever, but the cautious do not live at all.",
                    "Mountains are climbed one step at a time.",
                    "Your potential is like a mountain - it seems impossible until you start climbing."
                ]
            };

            // Determine theme based on prompt keywords
            const promptLower = prompt.toLowerCase();
            let selectedTheme = 'growth'; // default
            
            if (promptLower.includes('persist') || promptLower.includes('continue') || promptLower.includes('keep going') || promptLower.includes('quit') || promptLower.includes('give up')) {
                selectedTheme = 'persistence';
            } else if (promptLower.includes('balance') || promptLower.includes('harmony') || promptLower.includes('peace')) {
                selectedTheme = 'balance';
            } else if (promptLower.includes('hope') || promptLower.includes('future') || promptLower.includes('tomorrow') || promptLower.includes('miracle') || promptLower.includes('faith')) {
                selectedTheme = 'hope';
            } else if (promptLower.includes('courage') || promptLower.includes('brave') || promptLower.includes('strong') || promptLower.includes('fear')) {
                selectedTheme = 'courage';
            } else if (promptLower.includes('grow') || promptLower.includes('learn') || promptLower.includes('develop') || promptLower.includes('improve')) {
                selectedTheme = 'growth';
            }

            const quotes = themes[selectedTheme];
            const selectedQuote = quotes[Math.floor(Math.random() * quotes.length)];
            
            return {
                theme: selectedTheme,
                quote: selectedQuote
            };
        }

        async function generateVideo() {
            const prompt = document.getElementById('promptInput').value.trim();
            
            if (!prompt) {
                alert('Please enter a wisdom quote or concept!');
                return;
            }
            
            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.querySelector('.generate-btn').disabled = true;
            
            // Simulate AI processing time
            setTimeout(() => {
                // Generate wisdom content using client-side AI
                const wisdom = generateWisdomQuote(prompt);
                const videoId = `wisdom_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                
                const result = {
                    videoId,
                    prompt: prompt,
                    theme: wisdom.theme,
                    quote: wisdom.quote,
                    status: 'generated',
                    message: 'Video concept generated successfully'
                };
                
                // Show the generated content
                showGeneratedWisdom(result);
            }, 2000);
        }
        
        async function showGeneratedWisdom(result) {
            // Hide loading
            document.getElementById('loading').style.display = 'none';
            document.querySelector('.generate-btn').disabled = false;
            
            // Show generated wisdom content with rendering status
            const videoResult = document.getElementById('videoResult');
            videoResult.innerHTML = `
                <div style="padding: 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; margin-bottom: 15px; color: white;">
                    <h3 style="color: white; margin-bottom: 15px; font-size: 24px;">✨ Generated Wisdom Video</h3>
                    
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                        <p style="margin-bottom: 10px; font-weight: 600;">Your Prompt:</p>
                        <p style="font-style: italic; font-size: 18px;">"${result.prompt}"</p>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                        <p style="margin-bottom: 10px; font-weight: 600;">Generated Wisdom Quote:</p>
                        <p style="font-size: 20px; font-weight: 500; line-height: 1.4;">"${result.quote}"</p>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <p style="margin-bottom: 10px; font-weight: 600;">Theme:</p>
                        <p style="text-transform: capitalize; font-size: 18px;">${result.theme}</p>
                    </div>
                    
                    <div id="renderingStatus" style="text-align: center; background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <div class="loading-spinner" style="display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.3); border-top: 3px solid white; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 10px;"></div>
                        <p style="margin: 0;">🎬 Rendering your unique video...</p>
                    </div>
                    
                    <div style="text-align: center;">
                        <p style="font-size: 14px; opacity: 0.8;">Video ID: ${result.videoId}</p>
                    </div>
                </div>
                <button class="generate-btn" onclick="generateAnother()">
                    Generate Another Video
                </button>
            `;
            
            document.getElementById('videoResult').style.display = 'block';
            document.getElementById('videoResult').scrollIntoView({ behavior: 'smooth' });
            
            // Start rendering the actual video
            try {
                await renderVideo(result);
            } catch (error) {
                console.error('Video rendering failed:', error);
                document.getElementById('renderingStatus').innerHTML = `
                    <p style="margin: 0; color: #ffaaaa;">❌ Video rendering failed. Generating with current technology...</p>
                `;
                
                // Fallback: render with existing composition
                setTimeout(() => {
                    renderWithExistingComposition(result);
                }, 1000);
            }
        }
        
        async function renderVideo(result) {
            // Call the render API
            const response = await fetch('/api/render-video', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    prompt: result.prompt,
                    wisdomQuote: result.quote,
                    theme: result.theme,
                    videoId: result.videoId
                })
            });
            
            if (!response.ok) {
                throw new Error('Rendering API failed');
            }
            
            const renderResult = await response.json();
            
            // Update status
            document.getElementById('renderingStatus').innerHTML = `
                <p style="margin: 0;">✅ Video rendered successfully!</p>
                <video controls autoplay loop muted style="width: 100%; max-width: 400px; border-radius: 12px; background: #000; margin-top: 15px;">
                    <source src="${renderResult.videoUrl}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            `;
        }
        
        function renderWithExistingComposition(result) {
            // Map theme to existing video
            const themeVideoMap = {
                'growth': 'PlantingTreesWisdom',
                'persistence': 'WaterDropStone', 
                'hope': 'PlantingTreesWisdom',
                'balance': 'BambooOakWisdom',
                'courage': 'BambooOakWisdom'
            };
            
            const videoName = themeVideoMap[result.theme] || 'PlantingTreesWisdom';
            
            document.getElementById('renderingStatus').innerHTML = `
                <p style="margin: 0;">✅ Generated with ${result.theme} theme!</p>
                <video controls autoplay loop muted style="width: 100%; max-width: 400px; border-radius: 12px; background: #000; margin-top: 15px;">
                    <source src="${videoName}.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
                <p style="margin-top: 10px; font-size: 14px; opacity: 0.8;">
                    Powered by AI-generated wisdom + ${result.theme} visuals
                </p>
            `;
        }

        function showVideo(videoName) {
            // Hide loading
            document.getElementById('loading').style.display = 'none';
            document.querySelector('.generate-btn').disabled = false;
            
            // Show video with direct video player (fallback)
            const videoResult = document.getElementById('videoResult');
            videoResult.innerHTML = `
                <div style="padding: 20px; background: #f8f9fa; border-radius: 12px; margin-bottom: 15px;">
                    <h3 style="color: #333; margin-bottom: 15px;">✨ Generated: ${videoName}</h3>
                    <video controls autoplay loop muted style="width: 100%; max-width: 400px; border-radius: 12px; background: #000;">
                        <source src="${videoName}.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <p style="color: #666; margin-top: 10px; font-size: 14px;">
                        Right-click the video to save or share!
                    </p>
                </div>
                <button class="generate-btn" onclick="generateAnother()">
                    Generate Another Video
                </button>
            `;
            
            document.getElementById('videoResult').style.display = 'block';
            document.getElementById('videoResult').scrollIntoView({ behavior: 'smooth' });
        }
        
        function generateAnother() {
            document.getElementById('promptInput').value = '';
            document.getElementById('videoResult').style.display = 'none';
            document.getElementById('promptInput').focus();
        }
        
        // Allow Enter key to generate
        document.getElementById('promptInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                generateVideo();
            }
        });
    </script>
</body>
</html>